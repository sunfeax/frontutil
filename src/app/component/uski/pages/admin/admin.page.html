<div class="container">

  <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mb-3">
    <h1 class="h4 mb-0">
      <i class="bi bi-journal-text blog-icon me-2" aria-hidden="true"></i>
      Libro de visita
    </h1>

    <div class="d-flex justify-content-center my-3">
      <div class="card shadow-sm p-3 w-100" style="max-width: 720px">
        <div class="d-flex flex-wrap align-items-center gap-3">
          <label for="rellenaSelect" class="form-label m-0 fw-semibold"
            >Generar fake datos:</label
          >
          <select
            #cantidadSel
            id="rellenaSelect"
            class="form-select form-select-sm w-auto"
            (change)="onCantidadChange(cantidadSel.value)"
          >
            <option [selected]="rellenaCantidad === 5" value="5">5</option>
            <option [selected]="rellenaCantidad === 10" value="10">10</option>
            <option [selected]="rellenaCantidad === 50" value="50">50</option>
            <option [selected]="rellenaCantidad === 100" value="100">100</option>
          </select>
          <button
            class="btn btn-outline-primary btn-sm position-relative"
            [disabled]="rellenando"
            (click)="generarFake()"
          >
            @if (rellenando) {
            <span
              class="spinner-border spinner-border-sm me-2"
              role="status"
              aria-hidden="true"
            ></span>
            } @if (!rellenando) {
            <i class="bi bi-plus-circle me-2"></i>
            } Generar
          </button>

          @if (rellenaOk) {
          <div class="text-success small d-flex align-items-center">
            <i class="bi bi-check-circle me-1"></i>{{ rellenaOk }} posts
          </div>
          } @if (rellenaError) {
          <div class="text-danger small d-flex align-items-center">
            <i class="bi bi-exclamation-triangle me-1"></i>{{ rellenaError }}
          </div>
          }
        </div>
      </div>
    </div>

    <a
      class="btn btn-outline-secondary btn-sm me-3 d-none d-md-inline-flex align-items-center"
      routerLink="/visitas"
      title="Back to public list"
    >
      <i class="bi bi-arrow-left-square me-2" aria-hidden="true"></i>
      Volver
    </a>
  </div>

  <div class="list">
    <div class="card shadow-sm mt-3">
      @if (!oPage?.content?.length) {
        <div class="p-4 text-center text-muted">No hay registros.</div>
      } @else {
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0" style="table-layout: fixed; width: 100%;">
            <colgroup>
              <col style="width: 80px;" />
              <col style="width: 180px;" />
              <col style="width: 320px;" />
              <col style="width: 120px;" />
              <col style="width: 160px;" />
              <col style="width: 160px;" />
              <col style="width: 160px;" />
            </colgroup>
            <thead class="table-light">
              <tr>
                <th scope="col">ID</th>
                <th scope="col">Nombre</th>
                <th scope="col">Comentario</th>
                <th scope="col">Estado</th>
                <th scope="col">Creado</th>
                <th scope="col">Modificado</th>
                <th scope="col" class="text-end">Acciones</th>
              </tr>
            </thead>
            <tbody>
              @for (oVisita of oPage?.content; track oVisita.id) {
                <tr app-registro-tabla [visita]="oVisita"></tr>
              }
            </tbody>
          </table>
        </div>
      }
    </div>
  </div>

  <div class="d-flex justify-content-center align-items-center flex-wrap gap-3 mt-3">
    <app-paginacion
      [numPage]="numPage"
      [numPages]="oPage?.totalPages || 1"
      (pageChange)="goToPage($event)"
    >
    </app-paginacion>

    <app-botonera-rpp
      [numRpp]="numRpp"
      (rppChange)="onRppChange($event)">
    </app-botonera-rpp>
  </div>
</div>
