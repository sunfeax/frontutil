<div class="container my-4 edit-form">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-8">
            <div class="form-card">
                <header class="form-header mb-4">
                    <h1 class="form-title">Editar Pregunta</h1>
                    <p class="text-muted small">Modifica el texto de la pregunta</p>
                </header>

                @if (loading) {
                <div class="d-flex justify-content-center my-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Cargando...</span>
                    </div>
                </div>
                }

                @if (error) {
                <div class="alert alert-danger" role="alert">
                    <i class="bi bi-exclamation-triangle me-2"></i>{{ error }}
                </div>
                }

                @if (!loading && !error) {
                <form [formGroup]="soaresForm" (ngSubmit)="onSubmit()" novalidate>
                    <!-- Pregunta -->
                    <div class="mb-4">
                        <label for="preguntas" class="form-label">Pregunta <span class="text-danger">*</span></label>
                        <textarea class="form-control" [class.is-invalid]="preguntas?.invalid && preguntas?.touched"
                            [class.is-valid]="preguntas?.valid && preguntas?.touched" id="preguntas"
                            formControlName="preguntas" rows="5"
                            placeholder="Escribe tu pregunta al universo"></textarea>
                        @if (preguntas?.invalid && preguntas?.touched) {
                        <div class="invalid-feedback">
                            @if (preguntas?.errors?.['required']) {
                            <span>La pregunta es obligatoria.</span>
                            }
                            @if (preguntas?.errors?.['minlength']) {
                            <span>La pregunta debe tener al menos 3 caracteres.</span>
                            }
                            @if (preguntas?.errors?.['maxlength']) {
                            <span>La pregunta no puede superar 500 caracteres.</span>
                            }
                        </div>
                        }
                    </div>

                    <!-- Botones -->
                    <div class="d-flex justify-content-between align-items-center mt-4">
                        <a [routerLink]="['/soares/admin/plist']" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-left me-2"></i>Cancelar
                        </a>
                        <button type="submit" class="btn btn-primary" [disabled]="submitting || soaresForm.invalid">
                            @if (submitting) {
                            <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                            }
                            @if (!submitting) {
                            <i class="bi bi-check-circle me-2"></i>
                            }
                            Guardar Cambios
                        </button>
                    </div>
                </form>
                }
            </div>
        </div>
    </div>
</div>

<!-- Toast para notificaciones -->
<div class="position-fixed top-0 start-50 translate-middle-x p-3" style="z-index: 1050">
    @if (toastMessage) {
    <div class="toast show" role="alert" [class.bg-success]="toastType === 'success'"
        [class.bg-danger]="toastType === 'error'" [class.text-white]="true">
        <div class="toast-body d-flex align-items-center">
            @if (toastType === 'success') {
            <i class="bi bi-check-circle-fill me-2"></i>
            } @else {
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            }
            {{ toastMessage }}
            <button type="button" class="btn-close btn-close-white ms-auto" (click)="toastMessage = null"></button>
        </div>
    </div>
    }
</div>